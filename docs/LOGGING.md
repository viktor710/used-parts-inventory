# –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è Winston —Å —Ä–æ—Ç–∞—Ü–∏–µ–π —Ñ–∞–π–ª–æ–≤

## –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Winston** - –º–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Node.js —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–µ–π —Ñ–∞–π–ª–æ–≤ –ø–æ –¥–Ω—è–º.

## –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã

- `winston` (^3.17.0) - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `winston-daily-rotate-file` (^4.7.1) - –ø–ª–∞–≥–∏–Ω –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤
- `@types/winston` (^2.4.4) - —Ç–∏–ø—ã TypeScript

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–≥–µ—Ä (`lib/logger.ts`)

```typescript
import { Logger } from '@/lib/logger';

// –ë–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
Logger.info('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', { meta: 'data' });
Logger.warn('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ', { warning: 'details' });
Logger.error('–û—à–∏–±–∫–∞', { error: 'details' });
Logger.debug('–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', { debug: 'data' });
```

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã

```typescript
// API –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
Logger.api('GET', '/api/parts', 200, 150, { userAgent: 'browser' });

// –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
Logger.database('SELECT', 'parts', 45, { query: 'SELECT * FROM parts' });

// –í–∞–ª–∏–¥–∞—Ü–∏—è
Logger.validation('PartSchema', ['Field required'], { field: 'name' });

// –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
Logger.fileUpload('image.jpg', 1024 * 1024, 'success', { userId: '123' });

// –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
Logger.auth('login', 'user123', { ip: '127.0.0.1' });

// –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
Logger.performance('database_query', 250, { table: 'parts' });

// –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
Logger.fix('Component', 'Issue', 'Solution', { component: 'Test' });
```

## –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–æ—Ç–∞—Ü–∏–∏

- **–ü–∞—Ç—Ç–µ—Ä–Ω –¥–∞—Ç—ã**: `YYYY-MM-DD`
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞**: 20MB
- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: 14 –¥–Ω–µ–π
- **–°–∂–∞—Ç–∏–µ**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤ .gz –∞—Ä—Ö–∏–≤—ã

### –¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤

–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–µ–∂–∏–º–µ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:

1. **`combined-YYYY-MM-DD.log`** - –≤—Å–µ –ª–æ–≥–∏
2. **`error-YYYY-MM-DD.log`** - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
3. **`api-YYYY-MM-DD.log`** - API –∑–∞–ø—Ä–æ—Å—ã
4. **`database-YYYY-MM-DD.log`** - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
5. **`exceptions-YYYY-MM-DD.log`** - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
6. **`rejections-YYYY-MM-DD.log`** - –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–∏—Å—ã

## –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (development)
- –õ–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Å–æ–ª—å
- –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `debug`
- –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ —Å —ç–º–æ–¥–∑–∏

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω (production)
- –õ–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª—ã —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
- –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `info`
- JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

### JSON —Ñ–æ—Ä–º–∞—Ç
```json
{
  "level": "info",
  "message": "API GET /api/parts",
  "timestamp": "2025-09-01 21:40:02",
  "service": "used-parts-inventory",
  "method": "GET",
  "path": "/api/parts",
  "status": 200,
  "duration": "150ms"
}
```

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
```
üåê [21:40:02] INFO: API GET /api/parts {
  "method": "GET",
  "path": "/api/parts",
  "status": 200,
  "duration": "150ms"
}
```

## –≠–º–æ–¥–∑–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ª–æ–≥–æ–≤

- ‚ÑπÔ∏è **info** - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- ‚ö†Ô∏è **warn** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚ùå **error** - –æ—à–∏–±–∫–∏
- üîß **debug** - –æ—Ç–ª–∞–¥–∫–∞
- üåê **api** - API –∑–∞–ø—Ä–æ—Å—ã
- üóÑÔ∏è **database** - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
- ‚úÖ **validation** - –≤–∞–ª–∏–¥–∞—Ü–∏—è
- üìÅ **fileUpload** - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- üîê **auth** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚ö° **performance** - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üîß **fix** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# –¢–µ—Å—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npx tsx scripts/test-logger.ts

# –¢–µ—Å—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–µ–∂–∏–º–µ
npx tsx scripts/test-logger-prod.ts

# –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
npx tsx scripts/final-logger-test.ts
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–∞–ø–∫–∏ logs
dir logs

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
type logs\combined-2025-09-01.log
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
- –°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã (—Å—Ç–∞—Ä—à–µ 14 –¥–Ω–µ–π) —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –§–∞–π–ª—ã —Å–∂–∏–º–∞—é—Ç—Å—è –≤ .gz –∞—Ä—Ö–∏–≤—ã –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞

### –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–≥–æ–≤ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
rm -rf logs/*

# –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—ã—Ö –∞—Ä—Ö–∏–≤–æ–≤
rm logs/*.gz
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### API —Ä–æ—É—Ç—ã
```typescript
// app/api/parts/route.ts
import { Logger } from '@/lib/logger';

export async function GET(request: Request) {
  Logger.info('API /api/parts GET: –ó–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω', { 
    page, 
    limit, 
    filters 
  });
  
  // ... –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
  
  Logger.api('GET', '/api/parts', 200, duration, { 
    userAgent: request.headers.get('user-agent') 
  });
}
```

### Middleware
```typescript
// middleware.ts
import { Logger } from '@/lib/logger';

export function middleware(request: NextRequest) {
  const start = Date.now();
  
  // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
  
  const duration = Date.now() - start;
  Logger.performance('middleware', duration, { 
    path: request.nextUrl.pathname 
  });
}
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π
2. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç** –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ª–æ–≥–æ–≤
3. **–ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** (–ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã)
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**
5. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤** –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∞–π–ª—ã –ª–æ–≥–æ–≤ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ `logs/` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `NODE_ENV=production`

### –ü—Ä–æ–±–ª–µ–º–∞: –†–æ—Ç–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `winston-daily-rotate-file` –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### –ü—Ä–æ–±–ª–µ–º–∞: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ª–æ–≥–æ–≤
**–†–µ—à–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –æ–±—ä–µ–º–∞
